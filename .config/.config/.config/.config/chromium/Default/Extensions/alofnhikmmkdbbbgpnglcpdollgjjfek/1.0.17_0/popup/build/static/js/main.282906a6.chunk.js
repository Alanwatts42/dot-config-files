(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,r){"use strict";r.r(t),r.d(t,"bridge",function(){return u});var n=r(1),a=r.n(n),s=r(2),i=r(5),o=r(6),c=r(43),l=new(function(){function e(){Object(i.a)(this,e),this.nounce_=Date.now()}return Object(o.a)(e,[{key:"init",value:function(){var e=Object(s.a)(a.a.mark(function e(t,r,n){var i,o=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("Popup: Init bridge"),this.browser_=t,this.dispatch_=n,this.browserSupportsPromises_=r,this.clipperServerPort_=null,this.clipperServerPortStatus_="searching",this.browser_notify=function(){var e=Object(s.a)(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.info("Popup: Got command:",t),t.warning?(console.warn("Popup: Got warning: "+t.warning),o.dispatch({type:"WARNING_SET",text:t.warning})):o.dispatch({type:"WARNING_SET",text:""}),"clippedContent"===t.name&&(r={title:t.title,body_html:t.html,base_url:t.base_url,source_url:t.url,parent_id:t.parent_id,tags:t.tags||"",image_sizes:t.image_sizes||{},anchor_names:t.anchor_names||[]},o.dispatch({type:"CLIPPED_CONTENT_SET",content:r})),"isProbablyReaderable"===t.name&&o.dispatch({type:"IS_PROBABLY_READERABLE",value:t.value});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.browser_.runtime.onMessage.addListener(this.browser_notify),e.next=10,this.backgroundPage(this.browser_);case 10:i=e.sent,this.env_=i?i.joplinEnv():"prod",console.info("Popup: Env:",this.env()),this.dispatch({type:"ENV_SET",env:this.env()}),this.findClipperServerPort();case 15:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"backgroundPage",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.extension.getBackgroundPage())){e.next=3;break}return e.abrupt("return",r);case 3:return e.abrupt("return",new Promise(function(e,r){t.runtime.getBackgroundPage(function(t){e(t)})}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"env",value:function(){return this.env_}},{key:"browser",value:function(){return this.browser_}},{key:"dispatch",value:function(e){return this.dispatch_(e)}},{key:"scheduleStateSave",value:function(e){var t=this;this.scheduleStateSaveIID&&(clearTimeout(this.scheduleStateSaveIID),this.scheduleStateSaveIID=null),this.scheduleStateSaveIID=setTimeout(function(){t.scheduleStateSaveIID=null;var r={selectedFolderId:e.selectedFolderId};console.info("Popup: Saving state",r),t.storageSet(r)},100)}},{key:"restoreState",value:function(){var e=Object(s.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storageGet(null);case 2:if(t=e.sent,console.info("Popup: Restoring saved state:",t),t){e.next=6;break}return e.abrupt("return");case 6:t.selectedFolderId&&this.dispatch({type:"SELECTED_FOLDER_SET",id:t.selectedFolderId});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"findClipperServerPort",value:function(){var e=Object(s.a)(a.a.mark(function e(){var t,r,n,s,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.dispatch({type:"CLIPPER_SERVER_SET",foundState:"searching"}),t=null,r=0;case 3:if(!(r<10)){e.next=35;break}return t=c(t,this.env()),e.prev=5,console.info("findClipperServerPort: Trying "+t.port),e.next=9,fetch("http://127.0.0.1:"+t.port+"/ping");case 9:return n=e.sent,e.next=12,n.text();case 12:if(s=e.sent,console.info("findClipperServerPort: Got response: "+s),"JoplinClipperServer"!==s.trim()){e.next=28;break}return this.clipperServerPortStatus_="found",this.clipperServerPort_=t.port,this.dispatch({type:"CLIPPER_SERVER_SET",foundState:"found",port:t.port}),e.next=20,this.folderTree();case 20:return i=e.sent,this.dispatch({type:"FOLDERS_SET",folders:i}),e.next=24,this.clipperApiExec("GET","tags");case 24:return o=e.sent,this.dispatch({type:"TAGS_SET",tags:o}),u().restoreState(),e.abrupt("return");case 28:e.next=32;break;case 30:e.prev=30,e.t0=e.catch(5);case 32:r++,e.next=3;break;case 35:return this.clipperServerPortStatus_="not_found",this.dispatch({type:"CLIPPER_SERVER_SET",foundState:"not_found"}),e.abrupt("return",null);case 38:case"end":return e.stop()}},e,this,[[5,30]])}));return function(){return e.apply(this,arguments)}}()},{key:"clipperServerPort",value:function(){var e=Object(s.a)(a.a.mark(function e(){var t=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){var n=function(){return"not_found"===t.clipperServerPortStatus_?(r(new Error("Could not find clipper service. Please make sure that Joplin is running and that the clipper server is enabled.")),!0):"found"===t.clipperServerPortStatus_&&(e(t.clipperServerPort_),!0)};if(!n()){t.dispatch({type:"CONTENT_UPLOAD",operation:{searchingClipperServer:!0}});var a=setInterval(function(){n()&&(t.dispatch({type:"CONTENT_UPLOAD",operation:null}),clearInterval(a))},1e3)}}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clipperServerBaseUrl",value:function(){var e=Object(s.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.clipperServerPort();case 2:return t=e.sent,e.abrupt("return","http://127.0.0.1:"+t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"tabsExecuteScript",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.browserSupportsPromises_){e.next=2;break}return e.abrupt("return",this.browser().tabs.executeScript(t));case 2:return e.abrupt("return",new Promise(function(e,n){r.browser().tabs.executeScript(t,function(){var a=r.browser().runtime.lastError;if(a){var s=["tabsExecuteScript: Cannot load "+JSON.stringify(t)];a.message&&s.push(a.message),n(new Error(s.join(": ")))}e()})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"tabsQuery",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.browserSupportsPromises_){e.next=2;break}return e.abrupt("return",this.browser().tabs.query(t));case 2:return e.abrupt("return",new Promise(function(e,n){r.browser().tabs.query(t,function(t){e(t)})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"tabsSendMessage",value:function(){var e=Object(s.a)(a.a.mark(function e(t,r){var n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.browserSupportsPromises_){e.next=2;break}return e.abrupt("return",this.browser().tabs.sendMessage(t,r));case 2:return e.abrupt("return",new Promise(function(e,a){n.browser().tabs.sendMessage(t,r,function(t){e(t)})}));case 3:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"tabsCreate",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.browserSupportsPromises_){e.next=2;break}return e.abrupt("return",this.browser().tabs.create(t));case 2:return e.abrupt("return",new Promise(function(e,n){r.browser().tabs.create(t,function(){e()})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"folderTree",value:function(){var e=Object(s.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.clipperApiExec("GET","folders"));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"storageSet",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.browserSupportsPromises_){e.next=2;break}return e.abrupt("return",this.browser().storage.local.set(t));case 2:return e.abrupt("return",new Promise(function(e,n){r.browser().storage.local.set(t,function(){e()})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"storageGet",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r,n,s=this,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:null,!this.browserSupportsPromises_){e.next=14;break}return e.prev=2,e.next=5,this.browser().storage.local.get(t);case 5:return n=e.sent,e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",r);case 12:e.next=15;break;case 14:return e.abrupt("return",new Promise(function(e,r){s.browser().storage.local.get(t,function(t){e(t)})}));case 15:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"sendCommandToActiveTab",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tabsQuery({active:!0,currentWindow:!0});case 2:if((r=e.sent).length){e.next=6;break}return console.warn("No valid tab"),e.abrupt("return");case 6:return this.dispatch({type:"CONTENT_UPLOAD",operation:null}),console.info("Sending message ",t),e.next=10,this.tabsSendMessage(r[0].id,t);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clipperApiExec",value:function(){var e=Object(s.a)(a.a.mark(function e(t,r,n,s){var i,o,c,l,u,p,d,h;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("Popup: "+t+" "+r),e.next=3,this.clipperServerBaseUrl();case 3:if(i=e.sent,o={method:t,headers:{"Content-Type":"application/json"}},s&&(o.body="string"===typeof s?s:JSON.stringify(s)),c="",!n){e.next=19;break}l=[],e.t0=a.a.keys(n);case 10:if((e.t1=e.t0()).done){e.next=17;break}if(u=e.t1.value,n.hasOwnProperty(u)){e.next=14;break}return e.abrupt("continue",10);case 14:l.push(encodeURIComponent(u)+"="+encodeURIComponent(n[u])),e.next=10;break;case 17:(c=l.join("&"))&&(c="?"+c);case 19:return e.next=21,fetch(i+"/"+r+c,o);case 21:if((p=e.sent).ok){e.next=27;break}return e.next=25,p.text();case 25:throw d=e.sent,new Error(d);case 27:return e.next=29,p.json();case 29:return h=e.sent,e.abrupt("return",h);case 31:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"sendContentToJoplin",value:function(){var e=Object(s.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.info("Popup: Sending to Joplin..."),e.prev=1,this.dispatch({type:"CONTENT_UPLOAD",operation:{uploading:!0}}),t){e.next=5;break}throw new Error("Cannot send empty content");case 5:return e.next=7,this.clipperApiExec("POST","notes",{nounce:this.nounce_++},t);case 7:this.dispatch({type:"CONTENT_UPLOAD",operation:{uploading:!1,success:!0}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),'{"error":"Duplicate Nounce"}'===e.t0.message?this.dispatch({type:"CONTENT_UPLOAD",operation:{uploading:!1,success:!0}}):this.dispatch({type:"CONTENT_UPLOAD",operation:{uploading:!1,success:!1,errorMessage:e.t0.message}});case 13:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}()}]),e}()),u=function(){return l}},21:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQlJREFUeNpiXOjAwMD3kcFcSMeyls/Jz/w/ExPjwyNbTz88d6iF5R/DUYYFNgzm16ri3v579fo/DPx79+7/6fq0j5N0GWxZJP6w1mv+EhRieP+CgeHXVwYGBkYGxu+fGUz+CPI9/8vaxCLHpWDGcPMmA8Oe7QwMikoMYPDwPgPD1UsMioIK+iwcfCKMDLo6DAxszAwMH95CFLAC2braDIxXPjEyPf32+iyDsgoDg6gEAwMnHwSLiDMwqKgz3Pv77jLT/ed3G89cP/qJgYWHgYFblIGBB4hZeBnO3zr+5eGTmw3MQRIMj288unTk5Yt7cn9+fRd8/fT2jxMHV5y4dGJzBvPf//sBAgwATg5okojpGQ0AAAAASUVORK5CYII="},22:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQlJREFUeNpi5FzIwCDKx2BuImRZa8vnZ874n4lx18Otp488PNTCwsJwlIFnAYN5xbW4t1/+vfoPA1//vftffTrto+gkBlsWMQnWemNNQaG3DC8ZvgEhIxB+ZfzMYGoiyLf5OWsTs1uV8kQR0X9cPxn+Mvxg+M7wjuEZwwOG0wyPGU4w/Pn9j59FlEOEUYRBh+EfAzPDZ4a3DBDAzCDKoM3Ay/iJkenu09dnRRlUGAQZJBh4GfjAWIBBnEGSQZ3hxr13l5l/Or6/x/FbMMRUyoCdHyjJxcAN1M/EsOH8ni/bLu/NYJRezMDw8Q2DjbWiWb2jspUxIyMjw6G7Jy4cfnC8iZWF4QBAgAEAwzdc4OHO/RAAAAAASUVORK5CYII="},23:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQVJREFUeNo0js1KAlEAhb87XsG0BkYHciEy/UBFQYuioaAnCHqEli16h7KGnqAnKFoFbaNtRGIwRVEgjKA2C5k0NNTMCPI2JB04cBYfh0+cOKD3sZOZ1V19dtNWQhN+8cL1S9eHEvIc72EXz7eag3ZD/WfQayn3bLt9tMO6TMtobk4aSb7r0PkEJRA/XZYThh7Eoo7Mjlgr1D0oXUJqkr+8VyF4YsKwFmUsbgqyCxCNwFdzCMhwZ+YRvY7Qat23e8xpSKQhog8bHw/fZqj0W89a9bV8cOflO6hR0FIhYIYeYzxUCh9+4O1LIVT+xj3dqDW83JS1thQqUvZvH1/8giMVV78CDAB2jGGahqf6iwAAAABJRU5ErkJggg=="},27:function(e,t,r){e.exports=r(44)},38:function(e,t,r){},39:function(e,t,r){},43:function(e,t){e.exports=function(e,t){var r="prod"===t?41184:27583;return e?e.offset++:e={offset:0},e.port=r+e.offset,e}},44:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),s=r(2),i=r(0),o=r.n(i),c=r(20),l=r.n(c),u=(r(38),r(4)),p=r(5),d=r(6),h=r(13),f=r(11),v=r(14),b=(r(39),r(21)),g=r.n(b),m=r(22),E=r.n(m),S=r(23),w=r.n(S),y=r(19).connect,A=r(18).bridge,C=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).call(this))).bodyRef=o.a.createRef(),e}return Object(v.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.bodyRef.current.getElementsByTagName("img"),t=!0,r=!1,n=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var i=a.value;i.width/=2,i.height/=2}}catch(o){r=!0,n=o}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}}},{key:"render",value:function(){return o.a.createElement("div",{className:"Preview"},o.a.createElement("a",{className:"Confirm Button",onClick:this.props.onConfirmClick},"Confirm"),o.a.createElement("h2",null,"Preview:"),o.a.createElement("input",{className:"Title",value:this.props.title,onChange:this.props.onTitleChange}),o.a.createElement("div",{className:"BodyWrapper"},o.a.createElement("div",{className:"Body",ref:this.bodyRef,dangerouslySetInnerHTML:{__html:this.props.body_html}})))}}]),t}(o.a.PureComponent),T=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(f.a)(t).call(this))).state={contentScriptLoaded:!1,selectedTags:[],contentScriptError:""},e.confirm_click=function(){var t=Object.assign({},e.props.clippedContent);t.tags=e.state.selectedTags.join(","),t.parent_id=e.props.selectedFolderId,A().sendContentToJoplin(t)},e.contentTitle_change=function(t){e.props.dispatch({type:"CLIPPED_CONTENT_TITLE_SET",text:t.currentTarget.value})},e.clipSimplified_click=function(){A().sendCommandToActiveTab({name:"simplifiedPageHtml"})},e.clipComplete_click=function(){A().sendCommandToActiveTab({name:"completePageHtml"})},e.clipSelection_click=function(){A().sendCommandToActiveTab({name:"selectedHtml"})},e.clipUrl_click=function(){A().sendCommandToActiveTab({name:"pageUrl"})},e.clipScreenshot_click=Object(s.a)(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A().clipperServerBaseUrl();case 3:return r=t.sent,t.next=6,A().sendCommandToActiveTab({name:"screenshot",api_base_url:r,parent_id:e.props.selectedFolderId,tags:e.state.selectedTags.join(",")});case 6:window.close(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e.props.dispatch({type:"CONTENT_UPLOAD",operation:{uploading:!1,success:!1,errorMessage:t.t0.message}});case 12:case"end":return t.stop()}},t,this,[[0,9]])})),e.clipperServerHelpLink_click=function(){A().tabsCreate({url:"https://joplinapp.org/clipper/"})},e.folderSelect_change=function(t){e.props.dispatch({type:"SELECTED_FOLDER_SET",id:t.target.value})},e.tagCompChanged=e.tagCompChanged.bind(Object(u.a)(Object(u.a)(e))),e.onAddTagClick=e.onAddTagClick.bind(Object(u.a)(Object(u.a)(e))),e.onClearTagButtonClick=e.onClearTagButtonClick.bind(Object(u.a)(Object(u.a)(e))),e}return Object(v.a)(t,e),Object(d.a)(t,[{key:"onAddTagClick",value:function(e){var t=this.state.selectedTags.slice();t.push(""),this.setState({selectedTags:t}),this.focusNewTagInput_=!0}},{key:"onClearTagButtonClick",value:function(e){var t=e.target.getAttribute("data-index"),r=this.state.selectedTags.slice();r.splice(t,1),this.setState({selectedTags:r})}},{key:"tagCompChanged",value:function(e){var t=Number(e.target.getAttribute("data-index")),r=e.target.value;if(this.state.selectedTags.length<=t){var n=this.state.selectedTags.slice();n.push(r),this.setState({selectedTags:n})}else if(this.state.selectedTags[t]!==r){var a=this.state.selectedTags.slice();a[t]=r,this.setState({selectedTags:a})}}},{key:"loadContentScripts",value:function(){var e=Object(s.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A().tabsExecuteScript({file:"/content_scripts/JSDOMParser.js"});case 2:return e.next=4,A().tabsExecuteScript({file:"/content_scripts/Readability.js"});case 4:return e.next=6,A().tabsExecuteScript({file:"/content_scripts/Readability-readerable.js"});case 6:return e.next=8,A().tabsExecuteScript({file:"/content_scripts/index.js"});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(s.a)(a.a.mark(function e(){var t,r,n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadContentScripts();case 3:e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(0),console.error("Could not load content scripts",e.t0),this.setState({contentScriptError:e.t0.message}),e.abrupt("return");case 10:this.setState({contentScriptLoaded:!0}),t=!1,function e(r){for(var a=0;a<r.length;a++){var s=r[a];s.id===n.props.selectedFolderId&&(t=!0),s.children&&e(s.children)}}(this.props.folders),t||(r=this.props.folders.length?this.props.folders[0].id:null,this.props.dispatch({type:"SELECTED_FOLDER_SET",id:r})),A().sendCommandToActiveTab({name:"isProbablyReaderable"});case 16:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){if(this.focusNewTagInput_){this.focusNewTagInput_=!1;for(var e=null,t=0;t<100;t++){var r=this.refs["tagSelector"+t];if(!r)break;e=r}e&&e.focus()}}},{key:"render",value:function(){var e=this;if(!this.state.contentScriptLoaded){var t="Loading...";return this.state.contentScriptError&&(t="The Joplin extension is not available on this tab due to: "+this.state.contentScriptError),o.a.createElement("div",{style:{padding:10,fontSize:12,maxWidth:200}},t)}var r=this.props.warning?o.a.createElement("div",{className:"Warning"},this.props.warning):null,n=!!this.props.clippedContent,a=this.props.clippedContent,s=null,i=this.props.contentUploadOperation;if(i){var c="";c=i.searchingClipperServer?"Searching clipper service... Please make sure that Joplin is running.":i.uploading?"Processing note... The note will be available in Joplin as soon as the web page and images have been downloaded and converted. In the meantime you may close this popup.":i.success?"Note was successfully created!":"There was some error creating the note: "+i.errorMessage,s=o.a.createElement("div",{className:"Preview"},o.a.createElement("p",{className:"Info"},c))}else n&&(s=o.a.createElement(C,{onConfirmClick:this.confirm_click,title:a.title,body_html:a.body_html,onTitleChange:this.contentTitle_change}));for(var l=[],u=0;u<this.props.tags.length;u++){var p=this.props.tags[u];l.push(o.a.createElement("option",{key:p.id},p.title))}var d="Clip simplified page",h="";return this.props.isProbablyReaderable||(d+=" \u26a0\ufe0f",h="It might not be possible to create a good simplified version of this page.\nYou may want to clip the complete page instead."),o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"Controls"},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("a",{className:"Button",onClick:this.clipSimplified_click,title:h},d)),o.a.createElement("li",null,o.a.createElement("a",{className:"Button",onClick:this.clipComplete_click},"Clip complete page")),o.a.createElement("li",null,o.a.createElement("a",{className:"Button",onClick:this.clipSelection_click},"Clip selection")),o.a.createElement("li",null,o.a.createElement("a",{className:"Button",onClick:this.clipScreenshot_click},"Clip screenshot")),o.a.createElement("li",null,o.a.createElement("a",{className:"Button",onClick:this.clipUrl_click},"Clip URL")))),function(){var t=[];return function e(r,n){for(var a=0;a<r.length;a++){var s=r[a];t.push(o.a.createElement("option",{key:s.id,value:s.id},("    ".repeat(n)+s.title).replace(/ /g,"\xa0"))),s.children&&e(s.children,n+1)}}(e.props.folders,0),o.a.createElement("div",{className:"Folders"},o.a.createElement("label",null,"In notebook: "),o.a.createElement("select",{value:e.props.selectedFolderId||"",onChange:e.folderSelect_change},t))}(),o.a.createElement("div",{className:"Tags"},o.a.createElement("label",null,"Tags:"),function(){for(var t=[],r=0;r<e.state.selectedTags.length;r++)t.push(o.a.createElement("div",{key:r},o.a.createElement("input",{ref:"tagSelector"+r,"data-index":r,type:"text",list:"tags",value:e.state.selectedTags[r],onChange:e.tagCompChanged,onInput:e.tagCompChanged}),o.a.createElement("a",{"data-index":r,href:"#",className:"ClearTagButton",onClick:e.onClearTagButtonClick},"[x]")));return o.a.createElement("div",null,t,o.a.createElement("a",{className:"AddTagButton",href:"#",onClick:e.onAddTagClick},"Add tag"))}(),o.a.createElement("datalist",{id:"tags"},l)),r,s,function(){var t,r="",n=null,a=null,s=e.props.clipperServer.foundState;return"found"===s?(r="Ready on port "+e.props.clipperServer.port,n=E.a):(r="not_found"===(t=s)?"Not found":t.charAt(0).toUpperCase()+t.slice(1),n="searching"===s?w.a:g.a,"not_found"===s&&(a=o.a.createElement("a",{className:"Help",onClick:e.clipperServerHelpLink_click,href:"help"},"[Help]"))),r="Service status: "+r,o.a.createElement("div",{className:"StatusBar"},o.a.createElement("img",{alt:s,className:"Led",src:n}),o.a.createElement("span",{className:"ServerStatus"},r,a))}())}}]),t}(i.Component),k=y(function(e){return{warning:e.warning,clippedContent:e.clippedContent,contentUploadOperation:e.contentUploadOperation,clipperServer:e.clipperServer,folders:e.folders,tags:e.tags,selectedFolderId:e.selectedFolderId,isProbablyReaderable:e.isProbablyReaderable}})(T),x=r(19).Provider,_=r(18).bridge,O=r(10),P=O.createStore,N=O.applyMiddleware,j={warning:"",clippedContent:null,contentUploadOperation:null,clipperServer:{foundState:"idle",port:null},folders:[],tags:[],selectedFolderId:null,env:"prod",isProbablyReaderable:!0},R=function(e){return function(t){return function(){var r=Object(s.a)(a.a.mark(function r(n){var s,i;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=t(n),i=e.getState(),["SELECTED_FOLDER_SET"].indexOf(n.type)>=0&&_().scheduleStateSave(i),r.abrupt("return",s);case 4:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()}};function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,r=e;if("WARNING_SET"===t.type)(r=Object.assign({},e)).warning=t.text;else if("IS_PROBABLY_READERABLE"===t.type)(r=Object.assign({},e)).isProbablyReaderable=t.value;else if("CLIPPED_CONTENT_SET"===t.type)(r=Object.assign({},e)).clippedContent=t.content;else if("CLIPPED_CONTENT_TITLE_SET"===t.type){var n=(r=Object.assign({},e)).clippedContent?Object.assign({},r.clippedContent):{};n.title=t.text,r.clippedContent=n}else if("CONTENT_UPLOAD"===t.type)(r=Object.assign({},e)).contentUploadOperation=t.operation;else if("FOLDERS_SET"===t.type)(r=Object.assign({},e)).folders=t.folders,!r.selectedFolderId&&t.folders.length&&(r.selectedFolderId=t.folders[0].id);else if("TAGS_SET"===t.type)(r=Object.assign({},e)).tags=t.tags;else if("SELECTED_FOLDER_SET"===t.type)(r=Object.assign({},e)).selectedFolderId=t.id;else if("CLIPPER_SERVER_SET"===t.type){r=Object.assign({},e);var a=Object.assign({},r.clipperServer);"foundState"in t&&(a.foundState=t.foundState),"port"in t&&(a.port=t.port),r.clipperServer=a}else"ENV_SET"===t.type&&((r=Object.assign({},e)).env=t.env);return r}function D(){return(D=Object(s.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=P(I,N(R)),console.info("Popup: Init bridge and restore state..."),e.next=4,_().init(window.browser?window.browser:window.chrome,!!window.browser,t.dispatch);case 4:console.info("Popup: Creating React app..."),l.a.render(o.a.createElement(x,{store:t},o.a.createElement(k,null)),document.getElementById("root"));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}(function(){return D.apply(this,arguments)})().catch(function(e){console.error("Fatal error on initialisation:",e)})}},[[27,1,2]]]);
//# sourceMappingURL=main.282906a6.chunk.js.map